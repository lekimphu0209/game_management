{% extends "layout.html" %}
{% block title %}Qu·∫£n l√Ω V≈© kh√≠{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4" style="color: #00bfff;">üîß Qu·∫£n l√Ω H·ªá th·ªëng V≈© kh√≠</h2>


    <!-- Ch·ªçn ch·∫ø ƒë·ªô hi·ªÉn th·ªã -->
    <form method="GET" class="mb-4 d-flex gap-2">
        <button type="submit" name="view" value="used" class="btn btn-outline-secondary">üî• V≈© kh√≠ s·ª≠ d·ª•ng nhi·ªÅu</button>
        <button type="submit" name="view" value="all" class="btn btn-outline-secondary">üì¶ T·∫•t c·∫£ v≈© kh√≠</button>
    </form>

    <!-- Th√™m v≈© kh√≠ -->
    <div class="card mb-4">
        <div class="card-header bg-success text-white">
            ‚ûï Th√™m v≈© kh√≠ m·ªõi
        </div>
        <div class="card-body">
            <form method="POST" class="row g-3">
                <div class="col-md-3">
                    <input type="text" name="name" class="form-control" placeholder="T√™n v≈© kh√≠" required>
                </div>
                <div class="col-md-2">
                    <input type="text" name="type" class="form-control" placeholder="Lo·∫°i" required>
                </div>
                <div class="col-md-2">
                    <input type="number" name="damage" class="form-control" placeholder="S√°t th∆∞∆°ng" required>
                </div>
                <div class="col-md-3">
                    <input type="text" name="rarity" class="form-control" placeholder="ƒê·ªô hi·∫øm" required>
                </div>
                <div class="col-md-2">
                    <button type="submit" class="btn btn-success w-100">Th√™m</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Danh s√°ch v≈© kh√≠ -->
    {% if view_mode == 'used' %}
        <h4 style="color: #007bff; font-weight: bold;">üî• V≈© kh√≠ ƒë∆∞·ª£c s·ª≠ d·ª•ng nhi·ªÅu</h4>
        <table class="table table-hover table-bordered">
            <thead class="table-light">
                <tr>
                    <th>T√™n</th>
                    <th>Lo·∫°i</th>
                    <th>ƒê·ªô hi·∫øm</th>
                    <th>S·ªë l·∫ßn s·ª≠ d·ª•ng</th>
                </tr>
            </thead>
            <tbody>
                {% for weapon in usage_stats %}
                <tr>
                    <td>{{ weapon.name }}</td>
                    <td>{{ weapon.type }}</td>
                    <td>{{ weapon.rarity }}</td>
                    <td>{{ weapon.usage_count }}</td>
                </tr>
                {% else %}
                <tr><td colspan="4" class="text-center">Ch∆∞a c√≥ v≈© kh√≠ n√†o ƒë∆∞·ª£c s·ª≠ d·ª•ng.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <h4 style="color: #007bff; font-weight: bold;">üì¶ Danh s√°ch T·∫•t c·∫£ V≈© kh√≠</h4>

        <table class="table table-striped">
            <thead class="table-dark">
                <tr>
                    <th>T√™n</th>
                    <th>Lo·∫°i</th>
                    <th>S√°t th∆∞∆°ng</th>
                    <th>ƒê·ªô hi·∫øm</th>
                    <th>H√†nh ƒë·ªông</th>
                </tr>
            </thead>
            <tbody>
                {% for item in all_items %}
                <tr>
                    <td>{{ item.name }}</td>
                    <td>{{ item.type }}</td>
                    <td>{{ item.damage }}</td>
                    <td>{{ item.rarity }}</td>
                    <td><a class="btn btn-sm btn-primary" href="{{ url_for('edit_weapon', item_id=item.item_id) }}">Ch·ªânh s·ª≠a</a></td>
                </tr>
                {% else %}
                <tr><td colspan="5" class="text-center">Ch∆∞a c√≥ v≈© kh√≠ n√†o.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
</div>
{% endblock %}
